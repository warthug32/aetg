/*
Copyright (c) 2003-2011, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
(function(){function a(a,b,c){var d=a.join(" ");d=d.replace(/(,|>|\+|~)/g," "),d=d.replace(/\[[^\]]*/g,""),d=d.replace(/#[^\s]*/g,""),d=d.replace(/\:{1,2}[^\s]*/g,""),d=d.replace(/\s+/g," ");var e=d.split(" "),f=[];for(var g=0;g<e.length;g++){var h=e[g];c.test(h)&&!b.test(h)&&CKEDITOR.tools.indexOf(f,h)==-1&&f.push(h)}return f}function b(b,c,d){var e=[],f=[],g;for(g=0;g<b.styleSheets.length;g++){var h=b.styleSheets[g],i=h.ownerNode||h.owningElement;if(i.getAttribute("data-cke-temp"))continue;if(h.href&&h.href.substr(0,9)=="chrome://")continue;var j=h.cssRules||h.rules;for(var k=0;k<j.length;k++)f.push(j[k].selectorText)}var l=a(f,c,d);for(g=0;g<l.length;g++){var m=l[g].split("."),n=m[0].toLowerCase(),o=m[1];e.push({name:n+"."+o,element:n,attributes:{"class":o}})}return e}CKEDITOR.plugins.add("stylesheetparser",{requires:["styles"],onLoad:function(){var a=CKEDITOR.editor.prototype;a.getStylesSet=CKEDITOR.tools.override(a.getStylesSet,function(a){return function(c){var e=this;a.call(this,function(a){var d=e.config.stylesheetParser_skipSelectors||/(^body\.|^\.)/i,g=e.config.stylesheetParser_validSelectors||/\w+\.\w+/;c(e._.stylesDefinitions=a.concat(b(e.document.$,d,g)))})}})}})})();