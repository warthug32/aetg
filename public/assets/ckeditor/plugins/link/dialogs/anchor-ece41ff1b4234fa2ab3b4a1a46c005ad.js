/*
Copyright (c) 2003-2011, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
CKEDITOR.dialog.add("anchor",function(a){function c(a,b){return a.createFakeElement(b,"cke_anchor","anchor")}var b=function(a){this._.selectedElement=a;var b=a.data("cke-saved-name");this.setValueOf("info","txtName",b||"")};return{title:a.lang.anchor.title,minWidth:300,minHeight:60,onOk:function(){var b=this,d=b.getValueOf("info","txtName"),e={name:d,"data-cke-saved-name":d};if(b._.selectedElement)if(b._.selectedElement.data("cke-realelement")){var f=c(a,a.document.createElement("a",{attributes:e}));f.replace(b._.selectedElement)}else b._.selectedElement.setAttributes(e);else{var g=a.getSelection(),h=g&&g.getRanges()[0];if(h.collapsed){CKEDITOR.plugins.link.synAnchorSelector&&(e["class"]="cke_anchor_empty"),CKEDITOR.plugins.link.emptyAnchorFix&&(e.contenteditable="false",e["data-cke-editable"]=1);var i=a.document.createElement("a",{attributes:e});CKEDITOR.plugins.link.fakeAnchor&&(i=c(a,i)),h.insertNode(i)}else{CKEDITOR.env.ie&&CKEDITOR.env.version<9&&(e["class"]="cke_anchor");var j=new CKEDITOR.style({element:"a",attributes:e});j.type=CKEDITOR.STYLE_INLINE,j.apply(a.document)}}},onHide:function(){delete this._.selectedElement},onShow:function(){var c=this,d=a.getSelection(),e=d.getSelectedElement(),f;if(e)if(CKEDITOR.plugins.link.fakeAnchor){var g=CKEDITOR.plugins.link.tryRestoreFakeAnchor(a,e);g&&b.call(c,g),c._.selectedElement=e}else e.is("a")&&e.hasAttribute("name")&&b.call(c,e);else f=CKEDITOR.plugins.link.getSelectedLink(a),f&&(b.call(c,f),d.selectElement(f));c.getContentElement("info","txtName").focus()},contents:[{id:"info",label:a.lang.anchor.title,accessKey:"I",elements:[{type:"text",id:"txtName",label:a.lang.anchor.name,required:!0,validate:function(){return this.getValue()?!0:(alert(a.lang.anchor.errorName),!1)}}]}]}});