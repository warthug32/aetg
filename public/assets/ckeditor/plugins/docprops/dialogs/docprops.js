/*
Copyright (c) 2003-2011, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
CKEDITOR.dialog.add("docProps",function(a){function e(b,c){var d=function(){e(this),c(this,this._.parentDialog)},e=function(a){a.removeListener("ok",d),a.removeListener("cancel",e)},f=function(a){a.on("ok",d),a.on("cancel",e)};a.execCommand(b),a._.storedDialogs.colordialog?f(a._.storedDialogs.colordialog):CKEDITOR.on("dialogDefinition",function(a){if(a.data.name!=b)return;var c=a.data.definition;a.removeListener(),c.onLoad=CKEDITOR.tools.override(c.onLoad,function(a){return function(){f(this),c.onLoad=a,typeof a=="function"&&a.call(this)}})})}function f(){var a=this.getDialog(),b=a.getContentElement("general",this.id+"Other");if(!b)return;this.getValue()=="other"?(b.getInputElement().removeAttribute("readOnly"),b.focus(),b.getElement().removeClass("cke_disabled")):(b.getInputElement().setAttribute("readOnly",!0),b.getElement().addClass("cke_disabled"))}function g(b,c,e){return function(f,g,h){var i=d,j=typeof e!="undefined"?e:this.getValue();if(!j&&b in i)i[b].remove();else if(j&&b in i)i[b].setAttribute("content",j);else if(j){var k=new CKEDITOR.dom.element("meta",a.document);k.setAttribute(c?"http-equiv":"name",b),k.setAttribute("content",j),h.append(k)}}}function h(a,b){return function(){var c=d,e=a in c?c[a].getAttribute("content")||"":"";return b?e:(this.setValue(e),null)}}function i(a){return function(b,c,d,e){e.removeAttribute("margin"+a);var f=this.getValue();f!==""?e.setStyle("margin-"+a,CKEDITOR.tools.cssLength(f)):e.removeStyle("margin-"+a)}}function j(a){var b={},c=a.getElementsByTag("meta"),d=c.count();for(var e=0;e<d;e++){var f=c.getItem(e);b[f.getAttribute(f.hasAttribute("http-equiv")?"http-equiv":"name").toLowerCase()]=f}return b}function k(a,b,c){a.removeStyle(b),a.getComputedStyle(b)!=c&&a.setStyle(b,c)}var b=a.lang.docprops,c=a.lang.common,d={},l=function(a,c,d){return{type:"hbox",padding:0,widths:["60%","40%"],children:[CKEDITOR.tools.extend({type:"text",id:a,label:b[c]},d||{},1),{type:"button",id:a+"Choose",label:b.chooseColor,className:"colorChooser",onClick:function(){var b=this;e("colordialog",function(c){var d=b.getDialog();d.getContentElement(d._.currentTabId,a).setValue(c.getContentElement("picker","selectedColor").getValue())})}}]}},m="javascript:void((function(){"+encodeURIComponent("document.open();"+(CKEDITOR.env.isCustomDomain()?"document.domain='"+document.domain+"';":"")+'document.write( \'<html style="background-color: #ffffff; height: 100%"><head></head><body style="width: 100%; height: 100%; margin: 0px">'+b.previewHtml+"</body></html>' );"+"document.close();")+"})())";return{title:b.title,minHeight:330,minWidth:500,onShow:function(){var b=a.document,c=b.getElementsByTag("html").getItem(0),e=b.getHead(),f=b.getBody();d=j(b),this.setupContent(b,c,e,f)},onHide:function(){d={}},onOk:function(){var b=a.document,c=b.getElementsByTag("html").getItem(0),d=b.getHead(),e=b.getBody();this.commitContent(b,c,d,e)},contents:[{id:"general",label:c.generalTab,elements:[{type:"text",id:"title",label:b.docTitle,setup:function(a){this.setValue(a.getElementsByTag("title").getItem(0).data("cke-title"))},commit:function(a,b,c,d,e){if(e)return;a.getElementsByTag("title").getItem(0).data("cke-title",this.getValue())}},{type:"hbox",children:[{type:"select",id:"dir",label:c.langDir,style:"width: 100%",items:[[c.notSet,""],[c.langDirLtr,"ltr"],[c.langDirRtl,"rtl"]],setup:function(a,b,c,d){this.setValue(d.getDirection()||"")},commit:function(a,b,c,d){var e=this.getValue();e?d.setAttribute("dir",e):d.removeAttribute("dir"),d.removeStyle("direction")}},{type:"text",id:"langCode",label:c.langCode,setup:function(a,b){this.setValue(b.getAttribute("xml:lang")||b.getAttribute("lang")||"")},commit:function(a,b,c,d,e){if(e)return;var f=this.getValue();f?b.setAttributes({"xml:lang":f,lang:f}):b.removeAttributes({"xml:lang":1,lang:1})}}]},{type:"hbox",children:[{type:"select",id:"charset",label:b.charset,style:"width: 100%",items:[[c.notSet,""],[b.charsetASCII,"us-ascii"],[b.charsetCE,"iso-8859-2"],[b.charsetCT,"big5"],[b.charsetCR,"iso-8859-5"],[b.charsetGR,"iso-8859-7"],[b.charsetJP,"iso-2022-jp"],[b.charsetKR,"iso-2022-kr"],[b.charsetTR,"iso-8859-9"],[b.charsetUN,"utf-8"],[b.charsetWE,"iso-8859-1"],[b.other,"other"]],"default":"",onChange:function(){var a=this;a.getDialog().selectedCharset=a.getValue()!="other"?a.getValue():"",f.call(a)},setup:function(){var a=this;a.metaCharset="charset"in d;var b=h(a.metaCharset?"charset":"content-type",1,1),c=b.call(a);!a.metaCharset&&c.match(/charset=[^=]+$/)&&(c=c.substring(c.indexOf("=")+1));if(c){a.setValue(c.toLowerCase());if(!a.getValue()){a.setValue("other");var e=a.getDialog().getContentElement("general","charsetOther");e&&e.setValue(c)}a.getDialog().selectedCharset=c}f.call(a)},commit:function(a,b,c,e,f){var h=this;if(f)return;var i=h.getValue(),j=h.getDialog().getContentElement("general","charsetOther");i=="other"&&(i=j?j.getValue():""),i&&!h.metaCharset&&(i=(d["content-type"]?d["content-type"].getAttribute("content").split(";")[0]:"text/html")+"; charset="+i);var k=g(h.metaCharset?"charset":"content-type",1,i);k.call(h,a,b,c)}},{type:"text",id:"charsetOther",label:b.charsetOther,onChange:function(){this.getDialog().selectedCharset=this.getValue()}}]},{type:"hbox",children:[{type:"select",id:"docType",label:b.docType,style:"width: 100%",items:[[c.notSet,""],["XHTML 1.1",'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">'],["XHTML 1.0 Transitional",'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'],["XHTML 1.0 Strict",'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">'],["XHTML 1.0 Frameset",'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">'],["HTML 5","<!DOCTYPE html>"],["HTML 4.01 Transitional",'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">'],["HTML 4.01 Strict",'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">'],["HTML 4.01 Frameset",'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">'],["HTML 3.2",'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">'],["HTML 2.0",'<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">'],[b.other,"other"]],onChange:f,setup:function(){var b=this;if(a.docType){b.setValue(a.docType);if(!b.getValue()){b.setValue("other");var c=b.getDialog().getContentElement("general","docTypeOther");c&&c.setValue(a.docType)}}f.call(b)},commit:function(b,c,d,e,f){if(f)return;var g=this.getValue(),h=this.getDialog().getContentElement("general","docTypeOther");a.docType=g=="other"?h?h.getValue():"":g}},{type:"text",id:"docTypeOther",label:b.docTypeOther}]},{type:"checkbox",id:"xhtmlDec",label:b.xhtmlDec,setup:function(){this.setValue(!!a.xmlDeclaration)},commit:function(b,c,d,e,f){if(f)return;this.getValue()?(a.xmlDeclaration='<?xml version="1.0" encoding="'+(this.getDialog().selectedCharset||"utf-8")+'"?>',c.setAttribute("xmlns","http://www.w3.org/1999/xhtml")):(a.xmlDeclaration="",c.removeAttribute("xmlns"))}}]},{id:"design",label:b.design,elements:[{type:"hbox",widths:["60%","40%"],children:[{type:"vbox",children:[l("txtColor","txtColor",{setup:function(a,b,c,d){this.setValue(d.getComputedStyle("color"))},commit:function(a,b,c,d,e){if(this.isChanged()||e){d.removeAttribute("text");var f=this.getValue();f?d.setStyle("color",f):d.removeStyle("color")}}}),l("bgColor","bgColor",{setup:function(a,b,c,d){var e=d.getComputedStyle("background-color")||"";this.setValue(e=="transparent"?"":e)},commit:function(a,b,c,d,e){if(this.isChanged()||e){d.removeAttribute("bgcolor");var f=this.getValue();f?d.setStyle("background-color",f):k(d,"background-color","transparent")}}}),{type:"hbox",widths:["60%","40%"],padding:1,children:[{type:"text",id:"bgImage",label:b.bgImage,setup:function(a,b,c,d){var e=d.getComputedStyle("background-image")||"";e=="none"?e="":e=e.replace(/url\(\s*(["']?)\s*([^\)]*)\s*\1\s*\)/i,function(a,b,c){return c}),this.setValue(e)},commit:function(a,b,c,d){d.removeAttribute("background");var e=this.getValue();e?d.setStyle("background-image","url("+e+")"):k(d,"background-image","none")}},{type:"button",id:"bgImageChoose",label:c.browseServer,style:"display:inline-block;margin-top:10px;",hidden:!0,filebrowser:"design:bgImage"}]},{type:"checkbox",id:"bgFixed",label:b.bgFixed,setup:function(a,b,c,d){this.setValue(d.getComputedStyle("background-attachment")=="fixed")},commit:function(a,b,c,d){this.getValue()?d.setStyle("background-attachment","fixed"):k(d,"background-attachment","scroll")}}]},{type:"vbox",children:[{type:"html",id:"marginTitle",html:'<div style="text-align: center; margin: 0px auto; font-weight: bold">'+b.margin+"</div>"},{type:"text",id:"marginTop",label:b.marginTop,style:"width: 80px; text-align: center",align:"center",inputStyle:"text-align: center",setup:function(a,b,c,d){this.setValue(d.getStyle("margin-top")||d.getAttribute("margintop")||"")},commit:i("top")},{type:"hbox",children:[{type:"text",id:"marginLeft",label:b.marginLeft,style:"width: 80px; text-align: center",align:"center",inputStyle:"text-align: center",setup:function(a,b,c,d){this.setValue(d.getStyle("margin-left")||d.getAttribute("marginleft")||"")},commit:i("left")},{type:"text",id:"marginRight",label:b.marginRight,style:"width: 80px; text-align: center",align:"center",inputStyle:"text-align: center",setup:function(a,b,c,d){this.setValue(d.getStyle("margin-right")||d.getAttribute("marginright")||"")},commit:i("right")}]},{type:"text",id:"marginBottom",label:b.marginBottom,style:"width: 80px; text-align: center",align:"center",inputStyle:"text-align: center",setup:function(a,b,c,d){this.setValue(d.getStyle("margin-bottom")||d.getAttribute("marginbottom")||"")},commit:i("bottom")}]}]}]},{id:"meta",label:b.meta,elements:[{type:"textarea",id:"metaKeywords",label:b.metaKeywords,setup:h("keywords"),commit:g("keywords")},{type:"textarea",id:"metaDescription",label:b.metaDescription,setup:h("description"),commit:g("description")},{type:"text",id:"metaAuthor",label:b.metaAuthor,setup:h("author"),commit:g("author")},{type:"text",id:"metaCopyright",label:b.metaCopyright,setup:h("copyright"),commit:g("copyright")}]},{id:"preview",label:c.preview,elements:[{type:"html",id:"previewHtml",html:'<iframe src="'+m+'" style="width: 100%; height: 310px" hidefocus="true" frameborder="0" '+'id="cke_docProps_preview_iframe"></iframe>',onLoad:function(){this.getDialog().on("selectPage",function(a){if(a.data.page=="preview"){var b=this;setTimeout(function(){var a=CKEDITOR.document.getById("cke_docProps_preview_iframe").getFrameDocument(),c=a.getElementsByTag("html").getItem(0),d=a.getHead(),e=a.getBody();b.commitContent(a,c,d,e,1)},50)}}),CKEDITOR.document.getById("cke_docProps_preview_iframe").getAscendant("table").setStyle("height","100%")}}]}]}});