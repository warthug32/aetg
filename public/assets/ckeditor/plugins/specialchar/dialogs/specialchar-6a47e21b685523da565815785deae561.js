/*
Copyright (c) 2003-2011, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
CKEDITOR.dialog.add("specialchar",function(a){var b,c=a.lang.specialChar,d=function(c){var d,e;c.data?d=c.data.getTarget():d=new CKEDITOR.dom.element(c);if(d.getName()=="a"&&(e=d.getChild(0).getHtml())){d.removeClass("cke_light_background"),b.hide();var f=a.document.createElement("span");f.setHtml(e),a.insertText(f.getText())}},e=CKEDITOR.tools.addFunction(d),f,g=function(a,c){var d;c=c||a.data.getTarget(),c.getName()=="span"&&(c=c.getParent());if(c.getName()=="a"&&(d=c.getChild(0).getHtml())){f&&h(null,f);var e=b.getContentElement("info","htmlPreview").getElement();b.getContentElement("info","charPreview").getElement().setHtml(d),e.setHtml(CKEDITOR.tools.htmlEncode(d)),c.getParent().addClass("cke_light_background"),f=c}},h=function(a,c){c=c||a.data.getTarget(),c.getName()=="span"&&(c=c.getParent()),c.getName()=="a"&&(b.getContentElement("info","charPreview").getElement().setHtml("&nbsp;"),b.getContentElement("info","htmlPreview").getElement().setHtml("&nbsp;"),c.getParent().removeClass("cke_light_background"),f=undefined)},i=CKEDITOR.tools.addFunction(function(b){b=new CKEDITOR.dom.event(b);var c=b.getTarget(),e,f,i=b.getKeystroke(),j=a.lang.dir=="rtl";switch(i){case 38:if(e=c.getParent().getParent().getPrevious())f=e.getChild([c.getParent().getIndex(),0]),f.focus(),h(null,c),g(null,f);b.preventDefault();break;case 40:if(e=c.getParent().getParent().getNext())f=e.getChild([c.getParent().getIndex(),0]),f&&f.type==1&&(f.focus(),h(null,c),g(null,f));b.preventDefault();break;case 32:d({data:b}),b.preventDefault();break;case j?37:39:case 9:if(e=c.getParent().getNext())f=e.getChild(0),f.type==1?(f.focus(),h(null,c),g(null,f),b.preventDefault(!0)):h(null,c);else if(e=c.getParent().getParent().getNext())f=e.getChild([0,0]),f&&f.type==1?(f.focus(),h(null,c),g(null,f),b.preventDefault(!0)):h(null,c);break;case j?39:37:case CKEDITOR.SHIFT+9:(e=c.getParent().getPrevious())?(f=e.getChild(0),f.focus(),h(null,c),g(null,f),b.preventDefault(!0)):(e=c.getParent().getParent().getPrevious())?(f=e.getLast().getChild(0),f.focus(),h(null,c),g(null,f),b.preventDefault(!0)):h(null,c);break;default:return}});return{title:c.title,minWidth:430,minHeight:280,buttons:[CKEDITOR.dialog.cancelButton],charColumns:17,onLoad:function(){var b=this.definition.charColumns,d=a.config.extraSpecialChars,f=a.config.specialChars,g=CKEDITOR.tools.getNextId()+"_specialchar_table_label",h=['<table role="listbox" aria-labelledby="'+g+'"'+' style="width: 320px; height: 100%; border-collapse: separate;"'+' align="center" cellspacing="2" cellpadding="2" border="0">'],j=0,k=f.length,l,m;while(j<k){h.push("<tr>");for(var n=0;n<b;n++,j++){if(l=f[j]){m="";if(l instanceof Array)m=l[1],l=l[0];else{var o=l.replace("&","").replace(";","").replace("#","");m=c[o]||l}var p="cke_specialchar_label_"+j+"_"+CKEDITOR.tools.getNextNumber();h.push('<td class="cke_dark_background" style="cursor: default" role="presentation"><a href="javascript: void(0);" role="option" aria-posinset="'+(j+1)+'"',' aria-setsize="'+k+'"',' aria-labelledby="'+p+'"',' style="cursor: inherit; display: block; height: 1.25em; margin-top: 0.25em; text-align: center;" title="',CKEDITOR.tools.htmlEncode(m),'" onkeydown="CKEDITOR.tools.callFunction( '+i+', event, this )"'+' onclick="CKEDITOR.tools.callFunction('+e+', this); return false;"'+' tabindex="-1">'+'<span style="margin: 0 auto;cursor: inherit">'+l+"</span>"+'<span class="cke_voice_label" id="'+p+'">'+m+"</span></a>")}else h.push('<td class="cke_dark_background">&nbsp;');h.push("</td>")}h.push("</tr>")}h.push("</tbody></table>",'<span id="'+g+'" class="cke_voice_label">'+c.options+"</span>"),this.getContentElement("info","charContainer").getElement().setHtml(h.join(""))},contents:[{id:"info",label:a.lang.common.generalTab,title:a.lang.common.generalTab,padding:0,align:"top",elements:[{type:"hbox",align:"top",widths:["320px","90px"],children:[{type:"html",id:"charContainer",html:"",onMouseover:g,onMouseout:h,focus:function(){var a=this.getElement().getElementsByTag("a").getItem(0);setTimeout(function(){a.focus(),g(null,a)},0)},onShow:function(){var a=this.getElement().getChild([0,0,0,0,0]);setTimeout(function(){a.focus(),g(null,a)},0)},onLoad:function(a){b=a.sender}},{type:"hbox",align:"top",widths:["100%"],children:[{type:"vbox",align:"top",children:[{type:"html",html:"<div></div>"},{type:"html",id:"charPreview",className:"cke_dark_background",style:"border:1px solid #eeeeee;font-size:28px;height:40px;width:70px;padding-top:9px;font-family:'Microsoft Sans Serif',Arial,Helvetica,Verdana;text-align:center;",html:"<div>&nbsp;</div>"},{type:"html",id:"htmlPreview",className:"cke_dark_background",style:"border:1px solid #eeeeee;font-size:14px;height:20px;width:70px;padding-top:2px;font-family:'Microsoft Sans Serif',Arial,Helvetica,Verdana;text-align:center;",html:"<div>&nbsp;</div>"}]}]}]}]}]}});