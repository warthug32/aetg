(function(c){c.stackGallery=function(d){function N(a){for(var b=0,g,h;b<k;b++)if(g=e[b],h=c(g).attr("id"),h==a)break;return g}function O(){for(var a=0;a<k;a++)c(e[a])}function P(a){a||(a=k-1);var b=N(a);O();Q(a);var a=Math.random()*(R-s)+s+"deg",g=Math.random()*(D-v)+v+"deg";i=="verticalAbove"||i=="verticalRound"?c(b).animate({rotate:a,top:-E},{duration:t,easing:"easeOutCubic",complete:function(){e.unshift(e.pop());S(b);c(b).animate({rotate:g,top:0},{duration:j,easing:"easeOutExpo"});c(e[k-1]).animate({rotate:"0deg", duration:j,easing:"easeOutExpo"});p&&clearTimeout(p);p=setTimeout(T,j)}}):c(b).animate({rotate:a,left:i=="horizontalLeft"?-u:u},{duration:t,easing:"easeOutCubic",complete:function(){e.unshift(e.pop());S(b);c(b).animate({rotate:g,left:0},{duration:j,easing:"easeOutExpo"});c(e[k-1]).animate({rotate:"0deg",duration:j,easing:"easeOutExpo"});p&&clearTimeout(p);p=setTimeout(T,j)}})}function U(){var a=N(0);O();Q(c(e[k-1]).attr("id"));var b=Math.random()*(R-s)+s+"deg",g=Math.random()*(D-v)+v+"deg";i=="verticalAbove"|| i=="verticalRound"?c(a).animate({rotate:b,top:i=="verticalRound"?E:-E},{duration:t,easing:"easeOutCubic",complete:function(){fa(a,g)}}):c(a).animate({rotate:b,left:i=="horizontalLeft"?-u:u},{duration:t,easing:"easeOutCubic",complete:function(){ga(a,g)}})}function fa(a,b){e.push(e.shift());V(a);c(e[k-2]).animate({rotate:b,duration:j,easing:"easeOutExpo"});c(a).animate({rotate:0,top:0},{duration:j,easing:"easeOutExpo",complete:function(){z(c(a).attr("id"))}})}function ga(a,b){e.push(e.shift());V(a); c(e[k-2]).animate({rotate:b,duration:j,easing:"easeOutExpo"});c(a).animate({rotate:0,left:0},{duration:j,easing:"easeOutExpo",complete:function(){z(c(a).attr("id"))}})}function T(){p&&clearTimeout(p);z(c(e[k-1]).attr("id"))}function W(){var a=!1,b=document.URL,c=b.indexOf("://")+3,h=b.indexOf("/",c),b=b.substring(c,h).split("."),c=[1059,653,969,1728],h=[],f,e,d,k,i=b.length,j,l;for(f=0;f<i;f++){l=b[f];j=l.length;for(d=e=0;e<j;e++)k=l.charAt(e),d+=k.charCodeAt(0);h.push(d)}f=0;i=h.length;j=c.length; a:for(;f<i;f++)for(e=0;e<j;e++)if(h[f]==c[e]){a=!0;break a}return a}function Q(a){if(e[a].captions!=void 0)for(var b=0,a=e[a].captions,g=a.length,h;b<g;b++)h=c(a[b]),h.stop().animate({width:0},{duration:F,easing:"easeOutQuint"})}function z(a){if(e[a].captions!=void 0)for(var b=0,a=e[a].captions,g=a.length,h,f;b<g;b++)h=c(a[b]),f=a[b].finalInfoWidth,b!=g-1?h.delay(X*b).animate({width:f},{duration:F,easing:"easeOutQuint"}):b==g-1&&h.delay(X*b).animate({width:f},{duration:F,easing:"easeOutQuint",complete:function(){w("on"); l=!1;Y()}});else w("on"),l=!1,Y()}function ha(a){if(!a)a=window.event;a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation();a=c(a.currentTarget).attr("title");if(a=Z[a])return a=window.open(a,"myWindow"),window.focus&&a.focus(),!1}function Y(){o&&!G&&(m.stop().animate({height:0},{duration:r,easing:"linear",complete:H}),n.stop().animate({height:0},{duration:r,easing:"linear"}))}function H(){l=!0;w("off");x=="forward"?P():U();m.animate({height:q},{duration:500,easing:"easeOutExpo"});n.animate({height:q}, {duration:500,easing:"easeOutExpo"})}function $(){m.stop();n.stop();m.animate({height:q},{duration:500,easing:"easeOutExpo"});n.animate({height:q},{duration:500,easing:"easeOutExpo"})}function w(a){a=="on"?(I.css("cursor","pointer"),J.css("cursor","pointer")):(I.css("cursor","default"),J.css("cursor","default"))}function K(a){if(!a)a=window.event;a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation();a=c(a.currentTarget).attr("id");if(a=="slide_prev"){if(l)return;l=!0;w("off");U();$()}else if(a== "slide_toggle")o?(o=!1,m.stop(),n.stop(),A.css("display","block"),B.css("display","none")):(o=!0,A.css("display","none"),B.css("display","block"),l||(a=m.height()/q*r,a<0&&(a=0),m.stop().animate({height:0},{duration:a,easing:"linear",complete:H}),n.stop().animate({height:0},{duration:a,easing:"linear"})));else if(a=="slide_next"){if(l)return;l=!0;w("off");P();$()}return!1}function S(a){c(a).css("zIndex",0);c(a).attr("id",0);for(var a=1,b;a<k;a++)b=c(e[a]),b.attr("id",a),b.css("zIndex",a)}function V(a){c(a).css("zIndex", k-1);c(a).attr("id",k-1);for(var a=0,b;a<k-1;a++)b=c(e[a]),b.attr("id",a),b.css("zIndex",a)}function ia(){}c.browser.msie&&parseInt(c.browser.version,10);var Z=[],o=d.slideshowOn,r=d.slideshowDelay;if(W()){var aa=c("#sliderHolder"),y=c("#sliderImages"),ba=y.find("ul"),e=[],C=[],ca=d.imageWidth,da=d.imageHeight,L,ea=0,k=ba.length;c(ba).each(function(){L={};if(c(this).find("li[title=image]").length>0)L.imgUrl=c(this).find("li[title=image]").find("img").attr("src"),ea++;C.push(L)});var l=!1,p,t=d.upPartDuration, j=d.downPartDuration,s=d.maxRandomUpAngle,R=d.minRandomUpAngle,v=d.maxRandomDownAngle,D=d.minRandomDownAngle,ja=d.useControls,i=d.slideshowLayout;i!="horizontalLeft"&&i!="horizontalRight"&&i!="verticalAbove"&&i!="verticalRound"&&(i=verticalRound);var x=d.slideshowDirection;x!="forward"&&x!="backward"&&(x="forward");var X=d.captionOpenDelay,F=d.captionToggleSpeed,E=parseInt(da,10)+100,u=parseInt(ca,10)+50,q=c("#playimg").height(),M=c("#slideControls"),I=c("#slide_prev"),d=c("#slide_toggle"),J=c("#slide_next"); I.bind("click",K);d.bind("click",K);J.bind("click",K);M.css("opacity",0);var B=c("#pause_icon"),A=c("#play_icon"),m=c("#pause_icon2"),n=c("#play_icon2");A.css("display","none");B.css("display","none");o?B.css("display","block"):A.css("display","block");var G=!1;aa.mouseenter(function(){G=!0;!l&&o&&(m.stop(),n.stop())}).mouseleave(function(){G=!1;if(!l&&o){var a=m.height()/q*r;a<0&&(a=0);m.stop().animate({height:0},{duration:a,easing:"linear",complete:H});n.stop().animate({height:0},{duration:a,easing:"linear"})}}); setTimeout(function(){var a=0,b,g=0,h;if(W())for(var f,d,i,j,l,m,p,n,o,q,s,t,u,r,x=c("#fontMeasure");g<k;g++){b=c("<div></div>");b.css("display","none");b.attr("id",g);b.attr("title",g);b.attr("class","imageHolder");b.css("zIndex",g);b.css("top",Math.random()*35);b.css("left",Math.random()*25);i=Math.random()*(D-v)+v;aa.prepend(b);g!=k-1&&b.css({rotate:i+"deg"});C[g].imgUrl!=void 0&&(h=new Image,h=c(h),h.attr("id",g),h.css("position","relative"),h.css("width",ca),h.css("height",da),h.css("display", "block"),h.appendTo(b));y.find("ul:eq("+g+")").find("div[title=customContent]").length>0&&(i=y.find("ul:eq("+g+")").find("div[title=customContent]"),i.appendTo(b));m=0;p=y.find("ul:eq("+g+")").find("li[title=caption]").size();for(r=[];m<p;m++)f=y.find("ul:eq("+g+")").find("li[title=caption]").eq(m),i=f.css("backgroundColor"),d=f.css("color"),j=f.attr("class"),l=j.substring(0,j.indexOf(",")),j=j.substring(j.indexOf(",")+1),f=f.html(),f.indexOf("href")!=-1&&(b.bind("click",ha),b.css("cursor","pointer"), Z[g]=c(f).attr("href")),f=c("<div />").html(f).addClass("caption").appendTo(x),n=c(f).width()+1,o=c(f).height()+1,q=parseInt(c(f).css("paddingLeft"),10),s=parseInt(c(f).css("paddingRight"),10),t=parseInt(c(f).css("paddingTop"),10),u=parseInt(c(f).css("paddingBottom"),10),n=n+q+s,o=o+t+u,f.css("width",n),f.css("height",o),f.css("color",d),d=c("<div />").addClass("infoHolder"),f.appendTo(d),d.finalInfoWidth=n,d.css("width",0),d.css("height",o),d.css("left",parseInt(l,10)),d.css("top",parseInt(j,10)), d.css("background",i),d.appendTo(b),r.push(d);if(p>0)b.captions=r;e.push(b);C[g].imgUrl!=void 0?(b=C[g].imgUrl+"?rand="+Math.random()*99999999,c(h).load(function(){var b=c(this).attr("id"),b=c(e[b]);b.css("opacity",0);b.css("display","block");b.animate({opacity:1},{duration:1E3,easing:"easeOutSine"});a++;a==ea&&(gmap&&google.maps.event.trigger(gmap,"resize"),ja&&(M.css("display","block"),M.animate({opacity:1},{duration:500,easing:"easeOutSine"}),w("on")),z(k-1))}).attr("src",b),c(h).error(function(a){console.log("image load error "+ a)})):(b=c(e[g]),b.css("opacity",0),b.css("display","block"),b.animate({opacity:1},{duration:1E3,easing:"easeOutSine"}))}},1E3);c(window).resize(function(){clearTimeout(this.id);this.id=setTimeout(ia,500)})}}})(jQuery);